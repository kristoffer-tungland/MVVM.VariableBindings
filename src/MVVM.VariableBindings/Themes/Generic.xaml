<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:MVVM.VariableBindings"
                    xmlns:converters="clr-namespace:MVVM.VariableBindings.Converters">
  <converters:BoolToSuggestedHeaderConverter x:Key="BoolToSuggestedHeaderConverter" />
  <converters:ScopeHeaderConverter x:Key="ScopeHeaderConverter" />

  <Style TargetType="{x:Type local:VariableWrapper}">
    <Setter Property="Template">
      <Setter.Value>
        <ControlTemplate TargetType="{x:Type local:VariableWrapper}">
          <Grid Margin="2">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <ContentPresenter Grid.Column="0"
                              Margin="0,0,8,0"
                              VerticalAlignment="Center"
                              ContentSource="Content" />

            <ComboBox x:Name="PART_Combo"
                      Grid.Column="1"
                      Width="280"
                      Margin="2,0,0,0"
                      IsEditable="True"
                      IsTextSearchEnabled="True"
                      ItemsSource="{Binding Variable.CombinedView, RelativeSource={RelativeSource TemplatedParent}}"
                      SelectedValuePath="Name"
                      DisplayMemberPath="Name"
                      SelectedValue="{Binding Variable.Name, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
              <ComboBox.GroupStyle>
                <GroupStyle>
                  <GroupStyle.HeaderTemplate>
                    <DataTemplate>
                      <TextBlock Margin="4,8,0,2"
                                 FontWeight="SemiBold"
                                 Text="{Binding Name, Converter={StaticResource BoolToSuggestedHeaderConverter}}" />
                    </DataTemplate>
                  </GroupStyle.HeaderTemplate>
                </GroupStyle>
                <GroupStyle>
                  <GroupStyle.HeaderTemplate>
                    <DataTemplate>
                      <TextBlock Margin="12,6,0,2"
                                 Text="{Binding Name, Converter={StaticResource ScopeHeaderConverter}}" />
                    </DataTemplate>
                  </GroupStyle.HeaderTemplate>
                </GroupStyle>
              </ComboBox.GroupStyle>
            </ComboBox>
          </Grid>
        </ControlTemplate>
      </Setter.Value>
    </Setter>
  </Style>
</ResourceDictionary>
